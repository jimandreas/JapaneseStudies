<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Japanese Vocabulary Study</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&display=swap" rel="stylesheet">
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body { font-family: 'Noto Sans JP', sans-serif; background: #f5f5f0; color: #333; padding: 20px; max-width: 800px; margin: 0 auto; }
h1 { text-align: center; margin-bottom: 20px; font-size: 1.5rem; }
.tabs { display: flex; gap: 4px; margin-bottom: 20px; }
.tab-btn { flex: 1; padding: 12px; border: none; background: #ddd; font-size: 1rem; font-family: inherit; cursor: pointer; border-radius: 6px 6px 0 0; transition: background 0.2s; }
.tab-btn.active { background: #4a7c59; color: #fff; }
.list { display: none; }
.list.active { display: block; }
.row { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; align-items: center; padding: 10px 12px; border-bottom: 1px solid #e0e0d8; transition: background 0.15s; }
.row:hover { background: #eae8df; }
.jp { font-size: 2.6rem; font-weight: 700; }
.reading { font-size: 0.85rem; color: #888; }
.en { font-size: 1rem; }
.play-btn { background: none; border: none; cursor: pointer; font-size: 1.2rem; vertical-align: middle; margin-left: 6px; color: #2563eb; }
.dataset-selector { text-align: center; margin: 30px 0; }
.dataset-selector button { padding: 10px 20px; margin: 6px; border: 2px solid #4a7c59; background: #fff; color: #4a7c59; font-size: 1rem; font-family: inherit; cursor: pointer; border-radius: 6px; transition: background 0.2s, color 0.2s; }
.dataset-selector button:hover { background: #4a7c59; color: #fff; }
.flashcard-area, .quiz-area { text-align: center; }
.card { border: 2px solid #ccc; border-radius: 12px; min-height: 220px; display: flex; flex-direction: column; align-items: center; justify-content: center; margin: 20px auto; max-width: 500px; cursor: pointer; padding: 30px; transition: box-shadow 0.2s; background: #fff; }
.card:hover { box-shadow: 0 4px 16px rgba(0,0,0,0.12); }
.card .jp { font-size: 3rem; }
.card .reading { font-size: 1rem; color: #888; margin-top: 6px; }
.card .en { font-size: 1.3rem; margin-top: 12px; color: #4a7c59; font-weight: 700; }
.progress { font-size: 0.95rem; color: #666; margin: 10px 0; }
.grade-btns button, .nav-btn { padding: 10px 24px; margin: 6px; border: none; border-radius: 6px; font-size: 1rem; font-family: inherit; cursor: pointer; color: #fff; }
.grade-btns .knew { background: #4a7c59; }
.grade-btns .didnt { background: #c0392b; }
.nav-btn { background: #4a7c59; }
.quiz-option { display: block; width: 100%; max-width: 500px; margin: 8px auto; padding: 14px; border: 2px solid #ccc; border-radius: 8px; font-size: 1rem; font-family: inherit; cursor: pointer; background: #fff; transition: border-color 0.2s; }
.quiz-option:hover:not(:disabled) { border-color: #4a7c59; }
.quiz-option.correct { background: #27ae60; color: #fff; border-color: #27ae60; }
.quiz-option.incorrect { background: #c0392b; color: #fff; border-color: #c0392b; }
.summary { max-width: 500px; margin: 30px auto; padding: 30px; background: #fff; border-radius: 12px; border: 2px solid #4a7c59; }
.summary h2 { margin-bottom: 12px; color: #4a7c59; }
@media (max-width: 600px) {
  .row { grid-template-columns: 1fr; gap: 4px; }
}
</style>
</head>
<body>
<h1>Japanese Vocabulary Study</h1>
<div class="tabs">
  <button class="tab-btn active" data-tab="menu">Restaurant Menu</button>
  <button class="tab-btn" data-tab="garden">Japanese Garden</button>
  <button class="tab-btn" data-tab="phrases">Tourist Phrases</button>
  <button class="tab-btn" data-tab="flashcard">Flashcard</button>
  <button class="tab-btn" data-tab="quiz">Quiz</button>
</div>
<div id="menu" class="list active"></div>
<div id="garden" class="list"></div>
<div id="phrases" class="list"></div>
<div id="flashcard" class="list"></div>
<div id="quiz" class="list"></div>

<script>
const menuData = [
  { japanese: "寿司", reading: "Sushi", english: "Sushi" },
  { japanese: "刺身", reading: "Sashimi", english: "Sashimi (Sliced raw fish)" },
  { japanese: "天ぷら", reading: "Tempura", english: "Tempura (Battered and fried)" },
  { japanese: "ラーメン", reading: "Raamen", english: "Ramen" },
  { japanese: "うどん", reading: "Udon", english: "Udon (Thick wheat noodles)" },
  { japanese: "蕎麦", reading: "Soba", english: "Soba (Buckwheat noodles)" },
  { japanese: "味噌汁", reading: "Misoshiru", english: "Miso Soup" },
  { japanese: "枝豆", reading: "Edamame", english: "Edamame (Soybeans)" },
  { japanese: "餃子", reading: "Gyouza", english: "Gyoza (Dumplings)" },
  { japanese: "焼き鳥", reading: "Yakitori", english: "Yakitori (Grilled chicken skewers)" },
  { japanese: "お好み焼き", reading: "Okonomiyaki", english: "Okonomiyaki (Savory pancake)" },
  { japanese: "たこ焼き", reading: "Takoyaki", english: "Takoyaki (Octopus balls)" },
  { japanese: "カレーライス", reading: "Kareeraisu", english: "Curry Rice" },
  { japanese: "おにぎり", reading: "Onigiri", english: "Rice Ball" },
  { japanese: "牛丼", reading: "Gyudon", english: "Beef Bowl" },
  { japanese: "親子丼", reading: "Oyakodon", english: "Chicken and Egg Bowl" },
  { japanese: "カツ丼", reading: "Katsudon", english: "Pork Cutlet Bowl" },
  { japanese: "唐揚げ", reading: "Karaage", english: "Fried Chicken" },
  { japanese: "とんかつ", reading: "Tonkatsu", english: "Pork Cutlet" },
  { japanese: "すき焼き", reading: "Sukiyaki", english: "Sukiyaki (Hot pot)" },
  { japanese: "しゃぶしゃぶ", reading: "Shabushabu", english: "Shabu-shabu (Hot pot)" },
  { japanese: "焼きそば", reading: "Yakisoba", english: "Fried Noodles" },
  { japanese: "茶碗蒸し", reading: "Chawanmushi", english: "Savory Egg Custard" },
  { japanese: "漬物", reading: "Tsukemono", english: "Pickles" },
  { japanese: "納豆", reading: "Nattou", english: "Natto (Fermented soybeans)" },
  { japanese: "鰻", reading: "Unagi", english: "Eel" },
  { japanese: "マグロ", reading: "Maguro", english: "Tuna" },
  { japanese: "サーモン", reading: "Saamon", english: "Salmon" },
  { japanese: "海老", reading: "Ebi", english: "Shrimp" },
  { japanese: "イカ", reading: "Ika", english: "Squid" },
  { japanese: "タコ", reading: "Tako", english: "Octopus" },
  { japanese: "玉子", reading: "Tamago", english: "Egg (Omelet)" },
  { japanese: "生ビール", reading: "Namabiiru", english: "Draft Beer" },
  { japanese: "日本酒", reading: "Nihonshu", english: "Sake (Rice wine)" },
  { japanese: "焼酎", reading: "Shouchuu", english: "Shochu (Distilled spirit)" },
  { japanese: "梅酒", reading: "Umeshu", english: "Plum Wine" },
  { japanese: "緑茶", reading: "Ryokucha", english: "Green Tea" },
  { japanese: "抹茶", reading: "Matcha", english: "Matcha (Powdered green tea)" },
  { japanese: "水", reading: "Mizu", english: "Water" },
  { japanese: "ご飯", reading: "Gohan", english: "Rice (Cooked)" },
  { japanese: "定食", reading: "Teishoku", english: "Set Meal" },
  { japanese: "弁当", reading: "Bentou", english: "Bento Box" },
  { japanese: "懐石料理", reading: "Kaiseki Ryouri", english: "Kaiseki (Traditional multi-course)" },
  { japanese: "居酒屋", reading: "Izakaya", english: "Izakaya (Japanese pub)" },
  { japanese: "お任せ", reading: "Omakase", english: "Omakase (Chef's choice)" },
  { japanese: "醤油", reading: "Shouyu", english: "Soy Sauce" },
  { japanese: "わさび", reading: "Wasabi", english: "Wasabi" },
  { japanese: "ガリ", reading: "Gari", english: "Pickled Ginger" },
  { japanese: "割り箸", reading: "Waribashi", english: "Disposable Chopsticks" },
  { japanese: "お会計", reading: "Okaikei", english: "Bill / Check" }
];

const gardenData = [
  { japanese: "日本庭園", reading: "Nihon Teien", english: "Japanese Garden" },
  { japanese: "灯籠", reading: "Tourou", english: "Stone Lantern" },
  { japanese: "石灯籠", reading: "Ishidourou", english: "Stone Lantern (Specific)" },
  { japanese: "枯山水", reading: "Karesansui", english: "Dry Landscape (Rock Garden)" },
  { japanese: "池", reading: "Ike", english: "Pond" },
  { japanese: "鯉", reading: "Koi", english: "Koi Fish" },
  { japanese: "橋", reading: "Hashi", english: "Bridge" },
  { japanese: "太鼓橋", reading: "Taikobashi", english: "Drum Bridge (Arched)" },
  { japanese: "手水鉢", reading: "Chouzu bachi", english: "Water Basin" },
  { japanese: "蹲踞", reading: "Tsukubai", english: "Low Water Basin (for tea ceremony)" },
  { japanese: "鹿威し", reading: "Shishiodoshi", english: "Deer Scarer (Bamboo water rocker)" },
  { japanese: "水琴窟", reading: "Suikinkutsu", english: "Buried Earthen Jar (Sound feature)" },
  { japanese: "飛び石", reading: "Tobiishi", english: "Stepping Stones" },
  { japanese: "延段", reading: "Nobedan", english: "Paved Stone Path" },
  { japanese: "石", reading: "Ishi", english: "Stone / Rock" },
  { japanese: "岩", reading: "Iwa", english: "Large Rock / Boulder" },
  { japanese: "砂", reading: "Suna", english: "Sand" },
  { japanese: "砂利", reading: "Jari", english: "Gravel" },
  { japanese: "苔", reading: "Koke", english: "Moss" },
  { japanese: "松", reading: "Matsu", english: "Pine Tree" },
  { japanese: "桜", reading: "Sakura", english: "Cherry Blossom" },
  { japanese: "紅葉", reading: "Momiji", english: "Japanese Maple" },
  { japanese: "竹", reading: "Take", english: "Bamboo" },
  { japanese: "垣根", reading: "Kakine", english: "Fence / Hedge" },
  { japanese: "竹垣", reading: "Takegaki", english: "Bamboo Fence" },
  { japanese: "借景", reading: "Shakkei", english: "Borrowed Scenery" },
  { japanese: "東屋", reading: "Azumaya", english: "Gazebo / Pavilion" },
  { japanese: "茶室", reading: "Chashitsu", english: "Tea House" },
  { japanese: "島", reading: "Shima", english: "Island" },
  { japanese: "中島", reading: "Nakajima", english: "Central Island" },
  { japanese: "滝", reading: "Taki", english: "Waterfall" },
  { japanese: "遣水", reading: "Yarimizu", english: "Stream" },
  { japanese: "築山", reading: "Tsukiyama", english: "Artificial Hill" },
  { japanese: "平庭", reading: "Hiraniwa", english: "Flat Garden" },
  { japanese: "露地", reading: "Roji", english: "Tea Garden Path" },
  { japanese: "雪見灯籠", reading: "Yukimidourou", english: "Snow-viewing Lantern" },
  { japanese: "雪吊り", reading: "Yukitsuri", english: "Rope supports for trees (Winter)" },
  { japanese: "盆栽", reading: "Bonsai", english: "Bonsai" },
  { japanese: "石組", reading: "Ishigumi", english: "Rock Arrangement" },
  { japanese: "三尊石", reading: "Sanzonseki", english: "Three-Buddha Stone Arrangement" }
];

const phrasesData = [
  { japanese: "ありがとうございます", reading: "Arigatou gozaimasu", english: "Thank you very much" },
  { japanese: "すみません", reading: "Sumimasen", english: "Excuse me / I'm sorry" },
  { japanese: "お会計お願いします", reading: "Okaikei onegai shimasu", english: "The bill, please" },
  { japanese: "生ビール大をお願いします", reading: "Nama biiru dai o onegai shimasu", english: "A large draft beer, please" },
  { japanese: "トイレはどこですか", reading: "Toire wa doko desu ka", english: "Where is the toilet?" },
  { japanese: "駅はどちらですか", reading: "Eki wa dochira desu ka", english: "Which way to the train station?" },
  { japanese: "いくらですか", reading: "Ikura desu ka", english: "How much is it?" },
  { japanese: "これをください", reading: "Kore o kudasai", english: "This one, please" },
  { japanese: "英語を話せますか", reading: "Eigo o hanasemasu ka", english: "Do you speak English?" },
  { japanese: "わかりません", reading: "Wakarimasen", english: "I don't understand" },
  { japanese: "もう一度お願いします", reading: "Mou ichido onegai shimasu", english: "One more time, please" },
  { japanese: "助けてください", reading: "Tasukete kudasai", english: "Please help me" },
  { japanese: "写真を撮ってもいいですか", reading: "Shashin o totte mo ii desu ka", english: "May I take a photo?" },
  { japanese: "おすすめは何ですか", reading: "Osusume wa nan desu ka", english: "What do you recommend?" },
  { japanese: "予約をしたいのですが", reading: "Yoyaku o shitai no desu ga", english: "I'd like to make a reservation" },
  { japanese: "Wi-Fiはありますか", reading: "Waifai wa arimasu ka", english: "Is there Wi-Fi?" },
  { japanese: "クレジットカードは使えますか", reading: "Kurejitto kaado wa tsukaemasu ka", english: "Can I use a credit card?" },
  { japanese: "メニューをお願いします", reading: "Menyuu o onegai shimasu", english: "The menu, please" },
  { japanese: "お水をお願いします", reading: "Omizu o onegai shimasu", english: "Water, please" },
  { japanese: "ここはどこですか", reading: "Koko wa doko desu ka", english: "Where am I?" },
  { japanese: "タクシーを呼んでください", reading: "Takushii o yonde kudasai", english: "Please call a taxi" },
  { japanese: "チェックインお願いします", reading: "Chekkuin onegai shimasu", english: "Check-in, please" },
  { japanese: "何時ですか", reading: "Nanji desu ka", english: "What time is it?" },
  { japanese: "アレルギーがあります", reading: "Arerugii ga arimasu", english: "I have an allergy" },
  { japanese: "美味しいです", reading: "Oishii desu", english: "It's delicious" }
];

function speak(text) {
  if (!window.speechSynthesis) { alert("Speech synthesis not supported in this browser."); return; }
  window.speechSynthesis.cancel();
  const utter = new SpeechSynthesisUtterance(text);
  utter.lang = "ja-JP";
  const voices = window.speechSynthesis.getVoices();
  const jaVoice = voices.find(v => v.lang.startsWith("ja"));
  if (jaVoice) utter.voice = jaVoice;
  window.speechSynthesis.speak(utter);
}

function renderList(data, containerId) {
  const container = document.getElementById(containerId);
  container.innerHTML = data.map(item => `
    <div class="row">
      <div>
        <span class="jp">${item.japanese}</span>
        <button class="play-btn" onclick="speak('${item.japanese}')" title="Play pronunciation">&#9654;</button>
        <div class="reading">${item.reading}</div>
      </div>
      <div class="en">${item.english}</div>
    </div>
  `).join("");
}

function shuffle(arr) {
  const a = [...arr];
  for (let i = a.length - 1; i > 0; i--) { const j = Math.floor(Math.random() * (i + 1)); [a[i], a[j]] = [a[j], a[i]]; }
  return a;
}

function getDataset(name) {
  if (name === "menu") return [...menuData];
  if (name === "garden") return [...gardenData];
  if (name === "phrases") return [...phrasesData];
  return [...menuData, ...gardenData, ...phrasesData];
}

const _startCallbacks = {};
function datasetSelector(containerId, onSelect) {
  _startCallbacks[containerId] = onSelect;
  const el = document.getElementById(containerId);
  el.innerHTML = `<div class="dataset-selector"><h2>Choose a dataset</h2>
    <button onclick="_startCallbacks['${containerId}']('menu')">Menu</button>
    <button onclick="_startCallbacks['${containerId}']('garden')">Garden</button>
    <button onclick="_startCallbacks['${containerId}']('phrases')">Phrases</button>
    <button onclick="_startCallbacks['${containerId}']('both')">All</button></div>`;
}

// ---- Flashcard ----
function initFlashcard(dsName) {
  const cards = shuffle(getDataset(dsName));
  let idx = 0, known = 0, revealed = false;
  const el = document.getElementById("flashcard");

  function render() {
    if (idx >= cards.length) {
      el.innerHTML = `<div class="summary"><h2>Flashcard Complete!</h2>
        <p>You knew <strong>${known}</strong> of <strong>${cards.length}</strong> cards.</p>
        <button class="nav-btn" onclick="datasetSelector('flashcard', initFlashcard)">Restart</button></div>`;
      return;
    }
    const c = cards[idx];
    el.innerHTML = `<div class="flashcard-area">
      <div class="progress">Card ${idx + 1} of ${cards.length}</div>
      <div class="card" onclick="window._revealCard()">
        <div class="jp">${c.japanese}</div>
        <button class="play-btn" onclick="event.stopPropagation();speak('${c.japanese}')" title="Play pronunciation">&#9654;</button>
        ${revealed ? `<div class="reading">${c.reading}</div><div class="en">${c.english}</div>` : `<div style="margin-top:12px;color:#999">Tap card to reveal</div>`}
      </div>
      ${revealed ? `<div class="grade-btns">
        <button class="knew" onclick="window._gradeCard(true)">I knew it</button>
        <button class="didnt" onclick="window._gradeCard(false)">I didn't know</button>
      </div>` : `<button class="nav-btn" onclick="window._revealCard()">Reveal</button>`}
    </div>`;
  }

  window._revealCard = () => { if (!revealed) { revealed = true; render(); } };
  window._gradeCard = (k) => { if (k) known++; idx++; revealed = false; render(); };
  render();
}

// ---- Quiz ----
function initQuiz(dsName) {
  const allData = getDataset(dsName);
  const questions = shuffle(allData);
  let idx = 0, score = 0, answered = false;
  const el = document.getElementById("quiz");

  function render() {
    if (idx >= questions.length) {
      el.innerHTML = `<div class="summary"><h2>Quiz Complete!</h2>
        <p>Score: <strong>${score}</strong> / <strong>${questions.length}</strong></p>
        <button class="nav-btn" onclick="datasetSelector('quiz', initQuiz)">Restart</button></div>`;
      return;
    }
    const q = questions[idx];
    const distractors = shuffle(allData.filter(d => d.english !== q.english)).slice(0, 3);
    const options = shuffle([q, ...distractors]);
    answered = false;

    el.innerHTML = `<div class="quiz-area">
      <div class="progress">Question ${idx + 1} of ${questions.length} &mdash; Score: ${score}</div>
      <div class="card" style="cursor:default">
        <div class="jp">${q.japanese}</div>
        <button class="play-btn" onclick="speak('${q.japanese}')" title="Play pronunciation">&#9654;</button>
      </div>
      ${options.map((o, i) => `<button class="quiz-option" onclick="window._answer(${i},'${o.english.replace(/'/g, "\\'")}')">${o.english}</button>`).join("")}
      <div id="quiz-next" style="display:none"><button class="nav-btn" onclick="window._nextQ()">Next</button></div>
    </div>`;

    window._answer = (i, chosen) => {
      if (answered) return;
      answered = true;
      const btns = el.querySelectorAll(".quiz-option");
      btns.forEach(b => {
        b.disabled = true;
        if (b.textContent === q.english) b.classList.add("correct");
      });
      if (chosen === q.english) { score++; }
      else { btns[i].classList.add("incorrect"); }
      document.getElementById("quiz-next").style.display = "block";
    };
    window._nextQ = () => { idx++; render(); };
  }
  render();
}

// Init
renderList(menuData, "menu");
renderList(gardenData, "garden");
renderList(phrasesData, "phrases");
datasetSelector("flashcard", initFlashcard);
datasetSelector("quiz", initQuiz);

// Tabs
document.querySelectorAll(".tab-btn").forEach(btn => {
  btn.addEventListener("click", () => {
    document.querySelectorAll(".tab-btn").forEach(b => b.classList.remove("active"));
    document.querySelectorAll(".list").forEach(l => l.classList.remove("active"));
    btn.classList.add("active");
    document.getElementById(btn.dataset.tab).classList.add("active");
  });
});

// Load voices (some browsers load async)
if (window.speechSynthesis) {
  window.speechSynthesis.onvoiceschanged = () => {};
  window.speechSynthesis.getVoices();
}
</script>
</body>
</html>
